<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–°–ª–æ–≤–æ–£–≥–∞–¥–∞–π–∫–∞</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: sans-serif;
    }

    body {
      background: #f5f5f5;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .screen {
      width: 100%;
      max-width: 500px;
      display: none;
      flex-direction: column;
      align-items: center;
    }

    .screen.active {
      display: flex;
    }

    h1 {
      font-size: 2rem;
      margin: 20px 0;
      text-align: center;
    }

    .btn {
      background: #4A90E2;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 20px;
      margin: 8px 0;
      font-size: 1.1rem;
      cursor: pointer;
      width: 100%;
      max-width: 300px;
    }

    .btn.rules, .btn.difficulty, .btn.play, .btn.exit, .btn.lang {
      background: #4A90E2;
    }

    .btn.diff-easy { background: #7ed321; }
    .btn.diff-medium { background: #f5a623; }
    .btn.diff-hard { background: #d0021b; }
    .btn.diff-free { background: #9013fe; }

    .btn-back {
      background: #aaa;
    }

    .game-header {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
    }

    .menu-btn {
      font-size: 1.8rem;
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
    }

    .mini-menu {
      position: absolute;
      top: 60px;
      right: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      z-index: 10;
      display: none;
    }

    .mini-menu.active {
      display: block;
    }

    .mini-menu .btn {
      width: 120px;
      padding: 10px;
      margin: 5px;
      font-size: 0.95rem;
    }

    .grid {
      display: flex;
      flex-direction: column;
      margin: 20px 0;
      gap: 6px;
    }

    .row {
      display: flex;
      justify-content: center;
      gap: 6px;
    }

    .cell {
      width: 40px;
      height: 40px;
      border: 2px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.4rem;
      text-transform: uppercase;
      background: white;
    }

    .cell.correct {
      background: #D0021B;
      color: white;
    }

    .cell.present {
      background: #4A90E2;
      color: white;
    }

    .input-container {
      width: 100%;
      margin: 20px 0;
    }

    #wordInput {
      width: 100%;
      max-width: 300px;
      padding: 12px;
      font-size: 1.5rem;
      text-align: center;
      border: 2px solid #4A90E2;
      border-radius: 8px;
      text-transform: uppercase;
      font-family: sans-serif;
    }

    .message {
      margin: 15px 0;
      font-size: 1.3rem;
      text-align: center;
      min-height: 2em;
    }

    .rules-text {
      margin: 15px 0;
      font-size: 1rem;
      line-height: 1.5;
      text-align: center;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div id="menu" class="screen active">
    <h1 id="title">–°–ª–æ–≤–æ–£–≥–∞–¥–∞–π–∫–∞</h1>
    <button class="btn play" onclick="showScreen('game')">–ò–≥—Ä–∞—Ç—å</button>
    <button class="btn difficulty" onclick="showScreen('difficulty')">–°–ª–æ–∂–Ω–æ—Å—Ç—å</button>
    <button class="btn rules" onclick="showScreen('rules')">–ü—Ä–∞–≤–∏–ª–∞</button>
    <button class="btn lang" onclick="toggleLanguage()">üá∑üá∫ / üá¨üáß</button>
    <button class="btn exit" onclick="window.location.href='https://sergeevich11-png.github.io/github.io/'">–í—ã—Ö–æ–¥</button>
  </div>

  <div id="rules" class="screen">
    <h1 id="rules-title">–ü—Ä–∞–≤–∏–ª–∞</h1>
    <div class="rules-text" id="rules-text">–°–ª–æ–≤–æ –∏–∑ N –±—É–∫–≤ –∑–∞–≥–∞–¥—ã–≤–∞–µ—Ç—Å—è. –ò–≥—Ä–æ–∫ –¥–æ–ª–∂–µ–Ω –æ—Ç–≥–∞–¥–∞—Ç—å –µ–≥–æ –∑–∞ 5 –ø–æ–ø—ã—Ç–æ–∫.  
–ï—Å–ª–∏ –±—É–∫–≤–∞ –µ—Å—Ç—å –≤ —Å–ª–æ–≤–µ, –Ω–æ –Ω–µ –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ ‚Äî –æ–Ω–∞ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è **—Å–∏–Ω–∏–º**.  
–ï—Å–ª–∏ –±—É–∫–≤–∞ –µ—Å—Ç—å –∏ —Å—Ç–æ–∏—Ç –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ ‚Äî –æ–Ω–∞ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è **–∫—Ä–∞—Å–Ω—ã–º**.  
–ë—É–∫–≤–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è –≤ —Å–ª–æ–≤–µ, –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è.  
–í—Å–µ–≥–æ –¥–∞—ë—Ç—Å—è 5 –ø–æ–ø—ã—Ç–æ–∫. –ù–µ —É–≥–∞–¥–∞–ª ‚Äî –ø—Ä–æ–∏–≥—Ä–∞–ª.</div>
    <button class="btn btn-back" onclick="showScreen('menu')">–ù–∞–∑–∞–¥</button>
  </div>

  <div id="difficulty" class="screen">
    <h1 id="difficulty-title">–°–ª–æ–∂–Ω–æ—Å—Ç—å</h1>
    <button class="btn diff-easy" onclick="setDifficulty(3)">–õ–µ–≥–∫–æ</button>
    <button class="btn diff-medium" onclick="setDifficulty(5)">–°—Ä–µ–¥–Ω–µ</button>
    <button class="btn diff-hard" onclick="setDifficulty(7)">–°–ª–æ–∂–Ω–æ</button>
    <button class="btn diff-free" onclick="setDifficulty('free')">–°–≤–æ–±–æ–¥–Ω–æ</button>
    <button class="btn btn-back" onclick="showScreen('menu')">–ù–∞–∑–∞–¥</button>
  </div>

  <div id="game" class="screen">
    <div class="game-header">
      <button class="btn lang" id="langBtn" onclick="toggleLanguage()">üá∑üá∫ / üá¨üáß</button>
      <button class="menu-btn" onclick="toggleMiniMenu()">‚ãÆ</button>
    </div>

    <div class="mini-menu" id="miniMenu">
      <button class="btn" onclick="hideMiniMenu()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
      <button class="btn" onclick="resetGame()">–ó–∞–Ω–æ–≤–æ</button>
      <button class="btn btn-back" onclick="showScreen('menu'); hideMiniMenu()">–í—ã—Ö–æ–¥</button>
    </div>

    <div class="message" id="message"></div>
    <div class="grid" id="grid"></div>

    <div class="input-container">
      <input type="text" id="wordInput" maxlength="10" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false">
    </div>

    <button class="btn btn-back" id="endGameBtn" style="display:none;" onclick="showScreen('menu')">–í –º–µ–Ω—é</button>
  </div>

  <script>
    const translations = {
      ru: {
        title: "–°–ª–æ–≤–æ–£–≥–∞–¥–∞–π–∫–∞",
        play: "–ò–≥—Ä–∞—Ç—å",
        rules: "–ü—Ä–∞–≤–∏–ª–∞",
        difficulty: "–°–ª–æ–∂–Ω–æ—Å—Ç—å",
        exit: "–í—ã—Ö–æ–¥",
        "rules-title": "–ü—Ä–∞–≤–∏–ª–∞",
        "rules-text": "–°–ª–æ–≤–æ –∏–∑ N –±—É–∫–≤ –∑–∞–≥–∞–¥—ã–≤–∞–µ—Ç—Å—è. –ò–≥—Ä–æ–∫ –¥–æ–ª–∂–µ–Ω –æ—Ç–≥–∞–¥–∞—Ç—å –µ–≥–æ –∑–∞ 5 –ø–æ–ø—ã—Ç–æ–∫.\n–ï—Å–ª–∏ –±—É–∫–≤–∞ –µ—Å—Ç—å –≤ —Å–ª–æ–≤–µ, –Ω–æ –Ω–µ –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ ‚Äî –æ–Ω–∞ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è **—Å–∏–Ω–∏–º**.\n–ï—Å–ª–∏ –±—É–∫–≤–∞ –µ—Å—Ç—å –∏ —Å—Ç–æ–∏—Ç –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ ‚Äî –æ–Ω–∞ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è **–∫—Ä–∞—Å–Ω—ã–º**.\n–ë—É–∫–≤–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è –≤ —Å–ª–æ–≤–µ, –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è.\n–í—Å–µ–≥–æ –¥–∞—ë—Ç—Å—è 5 –ø–æ–ø—ã—Ç–æ–∫. –ù–µ —É–≥–∞–¥–∞–ª ‚Äî –ø—Ä–æ–∏–≥—Ä–∞–ª.",
        "difficulty-title": "–°–ª–æ–∂–Ω–æ—Å—Ç—å",
        "menu-btn": "‚ãÆ",
        easy: "–õ–µ–≥–∫–æ",
        medium: "–°—Ä–µ–¥–Ω–µ",
        hard: "–°–ª–æ–∂–Ω–æ",
        free: "–°–≤–æ–±–æ–¥–Ω–æ",
        back: "–ù–∞–∑–∞–¥",
        continue: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",
        restart: "–ó–∞–Ω–æ–≤–æ",
        "to-menu": "–í—ã—Ö–æ–¥",
        victory: "–ü–æ–±–µ–¥–∞!",
        gameOver: "–°–ª–æ–≤–æ:",
        inputPlaceholder: "–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ...",
        "end-game-btn": "–í –º–µ–Ω—é",
        langBtn: "üá∑üá∫ / üá¨üáß"
      },
      en: {
        title: "WordGuess",
        play: "Play",
        rules: "Rules",
        difficulty: "Difficulty",
        exit: "Exit",
        "rules-title": "Rules",
        "rules-text": "A word of N letters is hidden. The player must guess it in 5 attempts.\nIf a letter is in the word but not in its place ‚Äî it is highlighted **blue**.\nIf a letter is in the word and in its place ‚Äî it is highlighted **red**.\nA letter not in the word remains unhighlighted.\nYou have 5 attempts total. Failed to guess ‚Äî you lose.",
        "difficulty-title": "Difficulty",
        "menu-btn": "‚ãÆ",
        easy: "Easy",
        medium: "Medium",
        hard: "Hard",
        free: "Free",
        back: "Back",
        continue: "Continue",
        restart: "Restart",
        "to-menu": "Exit",
        victory: "Victory!",
        gameOver: "Word:",
        inputPlaceholder: "Enter word...",
        "end-game-btn": "Menu",
        langBtn: "üá∑üá∫ / üá¨üáß"
      }
    };

    const WORDS_RU = {
      3: ['—Å–æ–Ω', '–¥–æ–º', '–∫–æ—Ç', '–Ω–æ—Å', '–ª–µ—Å', '—Ä–æ—Ç', '—á–∞—Å', '—à–∞—Ä', '—Å–æ–∫', '–ª—É–∫', '–¥—ã–º', '–±–µ–≥', '–≤–µ—Å', '–≥–∞–∑', '–¥–∞—Ä', '–∂–∞—Ä', '–∫–∏—Ç', '–ª–æ–±', '–º–µ—Ö', '–ø—É—Ö'],
      5: ['–æ—Å–µ–Ω—å', '–ø–æ–≥–æ–¥–∞', '–ª–∏–º–æ–Ω', '–∞—Ä–±—É–∑', '–±–∞–≥–∞–∂', '–±–∏–ª–µ—Ç', '–≤–∞–≥–æ–Ω', '–≤–µ—Ç–µ—Ä', '–≤–∏–ª–∫–∞', '–≤–∏—à–Ω—è', '–≤—ã—à–∫–∞', '–≥–µ—Ä–æ–π', '–≥–ª–∏–Ω–∞', '–≥–æ—Ä–æ–¥', '–≥—Ä—É—à–∞', '–¥–≤–µ—Ä—å', '–¥–µ–≤–∏–∑', '–¥–æ–∂–¥—å', '–¥–æ—Å–∫–∞', '–¥—Ä–∞–∫–∞', '–µ–≥–µ—Ä—å', '–∑–µ—Ä–Ω–æ', '–∏–∫–æ–Ω–∞', '–∫–Ω–∏–≥–∞', '–∫–æ—à–∫–∞', '–ª–∞–º–ø–∞', '–ª–µ–Ω—Ç–∞', '–ª–æ–∂–∫–∞', '–ø–∞–∫–µ—Ç', '–ø–µ–Ω–∞–ª', '–ø–∏—Ä–æ–≥', '—Ä—É—á–∫–∞', '—Å–∞—Ö–∞—Ä', '—Å—É–º–∫–∞', '—Ç—Ä–∞–≤–∞', '—É–ª–∏—Ü–∞', '—Ñ–∏–ª—å–º', '—á–∞—à–∫–∞', '—à–∫–æ–ª–∞', '–±–∞–Ω–∞–Ω', '–∞–ø–µ–ª—å', '–æ–≥–æ–Ω—å', '—Å–Ω–µ–≥', '–º–æ–ª–æ–∫–æ', '—Å—Ç–æ–ª', '—Å—Ç–µ–Ω–∞', '–æ–∫–Ω–æ', '–¥–≤–µ—Ä—å', '–ø–æ–ª–∫–∞'],
      7: ['–∞–±—Ä–∏–∫–æ—Å', '–∞–≤—Ç–æ–º–∞—Ç', '–∞–∫—Ä–æ–±–∞—Ç', '–∞–ª—Ñ–∞–≤–∏—Ç', '–∞–Ω–∞–ª–∏–∑—ã', '–∞—Ä—Ç–∏—Å—Ç—ã', '–∞—Å—Ñ–∞–ª—å—Ç', '–±–∞—Ä–∞–Ω–∫–∞', '–±–∞—Å—Å–µ–π–Ω', '–±–µ–≥–µ–º–æ—Ç', '–±–∏–ª—å—è—Ä–¥', '–≤–∞—Ä–µ–Ω—å–µ', '–≤–µ—Ä—ë–≤–∫–∞', '–≥–∞–ª—Å—Ç—É–∫', '–¥–µ–≤–æ—á–∫–∞', '–µ–∂–µ–≤–∏–∫–∞', '–∫–∞–ø—É—Å—Ç–∞', '–∫–æ–ø–µ–π–∫–∞', '–º–∞–≥–∞–∑–∏–Ω', '–º–µ–¥–≤–µ–¥—å', '–Ω–∞–¥–µ–∂–¥–∞', '–ø–∞—Å–ø–æ—Ä—Ç', '–ø–æ–¥–∞—Ä–æ–∫', '–ø–æ–º–∏–¥–æ—Ä', '–ø—Ä–µ–¥–º–µ—Ç', '–ø—Ä–∏—Ä–æ–¥–∞', '—Ä–µ—Å–Ω–∏—Ü–∞', '—Ä–∏—Å—É–Ω–æ–∫', '—Ä—É–±–∞—à–∫–∞', '—Å—á–∞—Å—Ç—å–µ', '—Ç–∞–±–ª–∏—Ü–∞', '—Ç–∞—Ä–µ–ª–∫–∞', '—Ç–µ–ª–µ—Ñ–æ–Ω', '—Ç–µ–º–Ω–æ—Ç–∞', '—Ç–µ—Ç—Ä–∞–¥—å', '—Ç—Ä–µ–≤–æ–≥–∞', '—É—Ä–æ–≤–µ–Ω—å', '—á–µ–ª–æ–≤–µ–∫', '—á–∏—Å—Ç–æ—Ç–∞', '—é–Ω–æ—à–∞']
    };

    const WORDS_EN = {
      4: ['word', 'game', 'play', 'time', 'life', 'love', 'home', 'food', 'book', 'door', 'tree', 'fish', 'bird', 'hand', 'face', 'head', 'foot', 'road', 'rain', 'snow'],
      5: ['apple', 'house', 'water', 'music', 'money', 'light', 'night', 'paper', 'phone', 'pizza', 'robot', 'smile', 'sound', 'storm', 'sugar', 'table', 'tiger', 'train', 'truck', 'watch', 'world', 'zebra', 'beach', 'bread', 'chair', 'cloud', 'dance', 'dream', 'earth', 'flame', 'glass', 'heart', 'horse', 'juice', 'knife', 'lemon', 'magic', 'ocean', 'peace', 'plant', 'queen', 'radio', 'river', 'snake', 'space', 'speed', 'spoon', 'stone', 'sweet', 'taste', 'teeth'],
      6: ['animal', 'banana', 'beauty', 'bottle', 'butter', 'camera', 'castle', 'cheese', 'coffee', 'cookie', 'cotton', 'dragon', 'flower', 'forest', 'friend', 'garden', 'golden', 'hammer', 'island', 'jungle', 'kitten', 'ladder', 'laptop', 'mirror', 'monkey', 'orange', 'pencil', 'planet', 'rabbit', 'rocket', 'shadow', 'silver', 'singer', 'soccer', 'summer', 'sunset', 'tablet', 'target', 'ticket', 'turtle', 'winter', 'wizard', 'yellow', 'zigzag']
    };

    // –ï–î–ò–ù–´–ô –ì–õ–û–ë–ê–õ–¨–ù–´–ô –Ø–ó–´–ö
    let currentLanguage = localStorage.getItem('preferredLanguage') || 'ru';
    document.documentElement.lang = currentLanguage;

    let currentDifficulty = 5;
    let currentWord = '';
    let lastWord = '';
    let currentRow = 0;
    let gameState = 'active';

    function t(key) {
      return translations[currentLanguage][key] || key;
    }

    function updateTexts() {
      document.getElementById('title').textContent = t('title');
      document.querySelector('.btn.play').textContent = t('play');
      document.querySelector('.btn.rules').textContent = t('rules');
      document.querySelector('.btn.difficulty').textContent = t('difficulty');
      document.querySelector('.btn.exit').textContent = t('exit');
      document.getElementById('rules-title').textContent = t('rules-title');
      document.getElementById('rules-text').textContent = t('rules-text');
      document.getElementById('difficulty-title').textContent = t('difficulty-title');
      
      const diffButtons = document.querySelectorAll('.btn');
      for (const btn of diffButtons) {
        if (btn.classList.contains('diff-easy')) btn.textContent = t('easy');
        else if (btn.classList.contains('diff-medium')) btn.textContent = t('medium');
        else if (btn.classList.contains('diff-hard')) btn.textContent = t('hard');
        else if (btn.classList.contains('diff-free')) btn.textContent = t('free');
        else if (btn.classList.contains('btn-back')) btn.textContent = t('back');
      }

      const miniMenuBtns = document.querySelectorAll('.mini-menu .btn');
      if (miniMenuBtns[0]) miniMenuBtns[0].textContent = t('continue');
      if (miniMenuBtns[1]) miniMenuBtns[1].textContent = t('restart');
      if (miniMenuBtns[2]) miniMenuBtns[2].textContent = t('to-menu');

      document.getElementById('endGameBtn').textContent = t('end-game-btn');
      document.getElementById('langBtn').textContent = t('langBtn');
      document.getElementById('wordInput').placeholder = t('inputPlaceholder');
    }

    function toggleLanguage() {
      currentLanguage = currentLanguage === 'ru' ? 'en' : 'ru';
      document.documentElement.lang = currentLanguage;
      localStorage.setItem('preferredLanguage', currentLanguage); // ‚Üê –ï–î–ò–ù–´–ô –ö–õ–Æ–ß!
      updateTexts();
      if (document.getElementById('game').classList.contains('active')) {
        initGame();
      }
    }

    function getRandomWord(pool) {
      let word;
      do {
        word = pool[Math.floor(Math.random() * pool.length)];
      } while (word === lastWord && pool.length > 1);
      lastWord = word;
      return word;
    }

    function getWordPool() {
      const pool = currentLanguage === 'ru' ? WORDS_RU : WORDS_EN;
      if (currentDifficulty === 'free') {
        const allWords = [];
        for (let key in pool) {
          allWords.push(...pool[key]);
        }
        return allWords;
      } else {
        if (currentLanguage === 'ru') {
          if (currentDifficulty === 3) return pool[3] || pool[5];
          if (currentDifficulty === 5) return pool[5] || pool[3];
          if (currentDifficulty === 7) return pool[7] || pool[5];
        } else {
          if (currentDifficulty === 3) return pool[4] || pool[5];
          if (currentDifficulty === 5) return pool[5] || pool[4];
          if (currentDifficulty === 7) return pool[6] || pool[5];
        }
        return pool[5] || Object.values(pool)[0];
      }
    }

    function getWordLengthForDifficulty() {
      if (currentLanguage === 'ru') {
        if (currentDifficulty === 3) return 3;
        if (currentDifficulty === 5) return 5;
        if (currentDifficulty === 7) return 7;
        if (currentDifficulty === 'free') return null;
      } else {
        if (currentDifficulty === 3) return 4;
        if (currentDifficulty === 5) return 5;
        if (currentDifficulty === 7) return 6;
        if (currentDifficulty === 'free') return null;
      }
      return 5;
    }

    function initGame() {
      const pool = getWordPool();
      currentWord = getRandomWord(pool);
      currentRow = 0;
      gameState = 'active';

      document.getElementById('endGameBtn').style.display = 'none';
      document.getElementById('message').textContent = '';
      document.getElementById('wordInput').value = '';
      document.getElementById('wordInput').maxLength = currentWord.length;
      document.getElementById('wordInput').focus();

      const grid = document.getElementById('grid');
      grid.innerHTML = '';

      const rows = 5;
      const cols = currentWord.length;

      for (let r = 0; r < rows; r++) {
        const row = document.createElement('div');
        row.className = 'row';
        for (let c = 0; c < cols; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          row.appendChild(cell);
        }
        grid.appendChild(row);
      }
    }

    function inputLetter(letter) {
      if (gameState !== 'active') return;
      const input = document.getElementById('wordInput');
      if (input.value.length < currentWord.length) {
        input.value += letter.toLowerCase();
      }
    }

    function deleteLetter() {
      if (gameState !== 'active') return;
      const input = document.getElementById('wordInput');
      input.value = input.value.slice(0, -1);
    }

    function submitGuess() {
      if (gameState !== 'active') return;
      const input = document.getElementById('wordInput');
      let guess = input.value.trim().toLowerCase();

      if (guess.length !== currentWord.length) {
        input.value = '';
        input.focus();
        return;
      }

      const row = document.querySelectorAll('.row')[currentRow];
      const cells = row.querySelectorAll('.cell');

      for (let i = 0; i < cells.length; i++) {
        cells[i].textContent = guess[i].toUpperCase();
      }

      const result = analyzeGuess(guess, currentWord);
      for (let i = 0; i < cells.length; i++) {
        if (result[i] === 'correct') {
          cells[i].classList.add('correct');
        } else if (result[i] === 'present') {
          cells[i].classList.add('present');
        }
      }

      if (guess === currentWord) {
        gameState = 'won';
        document.getElementById('message').textContent = t('victory');
        document.getElementById('endGameBtn').style.display = 'block';
        document.getElementById('wordInput').disabled = true;
        return;
      }

      currentRow++;
      input.value = '';
      input.focus();

      if (currentRow >= 5) {
        gameState = 'lost';
        document.getElementById('message').textContent = `${t('gameOver')} ${currentWord.toUpperCase()}`;
        document.getElementById('endGameBtn').style.display = 'block';
        document.getElementById('wordInput').disabled = true;
      }
    }

    function analyzeGuess(guess, word) {
      const result = Array(word.length).fill('absent');
      const wordChars = word.split('');
      const guessChars = guess.split('');

      for (let i = 0; i < word.length; i++) {
        if (guessChars[i] === wordChars[i]) {
          result[i] = 'correct';
          wordChars[i] = null;
        }
      }

      for (let i = 0; i < word.length; i++) {
        if (result[i] !== 'correct') {
          const index = wordChars.indexOf(guessChars[i]);
          if (index !== -1) {
            result[i] = 'present';
            wordChars[index] = null;
          }
        }
      }

      return result;
    }

    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
      document.getElementById(id).classList.add('active');

      if (id === 'game') {
        initGame();
      }
    }

    function setDifficulty(diff) {
      currentDifficulty = diff;
      showScreen('menu');
    }

    function toggleMiniMenu() {
      const menu = document.getElementById('miniMenu');
      menu.classList.toggle('active');
    }

    function hideMiniMenu() {
      document.getElementById('miniMenu').classList.remove('active');
    }

    function resetGame() {
      initGame();
      hideMiniMenu();
    }

    document.addEventListener('DOMContentLoaded', () => {
      updateTexts();

      const input = document.getElementById('wordInput');
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          submitGuess();
        }
      });

      input.addEventListener('input', (e) => {
        let value = e.target.value;
        const regex = currentLanguage === 'ru' ? /^[–∞-—è—ë]*$/i : /^[a-z]*$/i;
        if (!regex.test(value)) {
          e.target.value = value.slice(0, -1);
        }
        if (value.length > currentWord.length) {
          e.target.value = value.slice(0, currentWord.length);
        }
        e.target.value = e.target.value.toUpperCase();
      });
    });
  </script>
</body>
</html>
